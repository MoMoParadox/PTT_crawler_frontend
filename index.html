<!DOCTYPE html>
<html lang="en">

<head>
    <title>PTT_Crawler</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body>
    <!-- 標頭 -->
		<nav class="navbar navbar-expand-md navbar-dark sticky-top" style="background-color: #00cc99;">
			<div class="container">
				<a class="navbar-brand" href="#" style="font-size: 24px;">
					<img class="mr-2" src="./img/ncku-logo-b.png" height="36" class="d-inline-block align-top" alt="">
					宅宅
				</a>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
				 aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse justify-content-end" id="navbarNav">
					<ul class="navbar-nav nav nav-pills">
						<li class="nav-item info">
							<a class="nav-link bg-transparent" data-toggle="pill" href="#" style="font-size: 18px;">簡介 <span class="sr-only">(current)</span></a>
						</li>
						<li class="nav-item map_page">
							<a class="nav-link bg-transparent active" data-toggle="pill" href="#map_page" style="font-size: 18px;">地圖</a>
						</li>
						<li class="nav-item data_analyze">
							<a class="nav-link bg-transparent" data-toggle="pill" onclick="javascript:location.href='data_analyze.html';"
							 href="#data_analyze" style="font-size: 18px;">數據分析</a>
						</li>
						<li class="nav-item sport_page">
							<a class="nav-link bg-transparent" data-toggle="pill" href="#" style="font-size: 18px;">運動路徑</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
    <div class="container">
        <div class="column" style="margin-block-end:10px; padding:10px;">
            <div class="row">
                <div class="col-7">
                    <h1>PTT Crawler</h1>
                </div>

                <div class="col-5 text-right" style="min-height: 86px;">
                    <div class="collapse" style="float:left; margin-left:2px; padding:2px; margin:10px; min-width: 250px;" id="demo">
                        <input type="text" class="form-control" id="board" placeholder="請輸入版名　 ex : gossiping">
                        <input type="text" class="form-control" id="kw" placeholder="請輸入關鍵字 ex : 台灣" style="margin-top: 2px;">
                    </div>
                    <span>
                        <div><button type="btn" class="btn btn-info" style="margin:10px;" id='btn' onclick="search();">點我看懶人包</button></div>
                        <div><button type="btn" style="background-color: white; border:none;" data-toggle="collapse" data-target="#demo"><i class="material-icons">search</i></button></div>
                    </span>
                </div>
            </div>
            <div class="row"  id='d1'>
                <div class="col-7">
                    <h3>搜尋結果</h3>
                    <p id='hot'></p>
                </div>
                <div class="col-5">
                    <h3>熱門文章</h3>
                    <p id='result'></p>
                </div>
            </div>
            <div id='d2'>
                <h3 align="right">關鍵字</h3>
                <img id='wc' src=""></img>
            </div>
        </div>
    </div>
    <!-- <script>
        $('.btn').click(function() {
	        search();
        });
        res = ""

        async function search() {
            document.getElementById('result').innerHTML = 'gogo';
            console.log('start to search!');
            const b = document.getElementById('board');
            const k = document.getElementById('kw');
            console.log('board: %s, kw: %s', b.value, k.value);
            
            const url = 'http://crawler4ptt.herokuapp.com/search';
            const data = {board: b.value, kw:k.value};

            // fetch(url, {
            // method: 'POST', // or 'PUT'
            // body: JSON.stringify(data), // data can be `string` or {object}!
            // headers: new Headers({
            //     'Content-Type': 'application/json'
            // })
            // }).then(res => {
            //     const { wc_url, hot, result } = res.json;
            //     console.log("url:%s\n hot:%s\n result:%s", wc_url, hot, result);
            //     document.getElementById('result').innerHTML = result;
            //     document.getElementById('hot').innerHTML = hot;
            //     document.getElementById('wc').src = wc_url;
            // })
            // .catch(error => console.error('Error:', error))
            // .then(response => console.log('Success:', response));   
            const options = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data),
            }
            const response = await fetch(url, options);
            const d = await response.json();
            console.log('print request json: %s', d);

            const { wc_url, hot, result } = d;
            console.log("url:%s\n hot:%s\n result:%s", wc_url, hot, result);
            document.getElementById('result').innerHTML = result;
            document.getElementById('hot').innerHTML = hot;
            document.getElementById('wc').src = wc_url;

        }
    </script> -->
    <script src="./main.js" type="text/javascript" charset="utf-8"></script>
</body>

</html>